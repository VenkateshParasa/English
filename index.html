<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self';
                   script-src 'self' 'unsafe-inline';
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
                   font-src 'self' https://fonts.gstatic.com;
                   connect-src 'self' https://api.dictionaryapi.dev;">
    <meta name="description" content="Interactive English Learning Portal with vocabulary, sentence formation, reading, listening, and puzzle exercises">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="English Portal">
    <title>English Learning Portal</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/accessibility.css">
    <link rel="stylesheet" href="performance.css">
    <link rel="stylesheet" href="css/notifications.css">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Preconnect to external APIs for better performance -->
    <link rel="preconnect" href="https://api.dictionaryapi.dev">
    <link rel="dns-prefetch" href="https://api.dictionaryapi.dev">

    <!-- Icons for various devices -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <div class="container">
        <header role="banner">
            <div class="header-content">
                <h1>üéì English Learning Portal</h1>
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark/light theme">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
            <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" aria-label="Overall learning progress">
                <div class="progress-fill" id="overallProgress"></div>
            </div>
            <p class="progress-text">Overall Progress: <span id="progressPercent" aria-live="polite">0%</span></p>
        </header>

        <nav class="main-nav" role="navigation" aria-label="Main navigation">
            <button class="nav-btn active" data-section="dashboard" aria-label="Go to Dashboard" aria-current="page" aria-controls="dashboard">üìä Dashboard</button>
            <button class="nav-btn" data-section="vocabulary" aria-label="Go to Vocabulary section" aria-controls="vocabulary">üìö Vocabulary</button>
            <button class="nav-btn" data-section="sentences" aria-label="Go to Sentences section" aria-controls="sentences">‚úçÔ∏è Sentences</button>
            <button class="nav-btn" data-section="reading" aria-label="Go to Reading section" aria-controls="reading">üìñ Reading</button>
            <button class="nav-btn" data-section="listening" aria-label="Go to Listening section" aria-controls="listening">üéß Listening</button>
            <button class="nav-btn" data-section="puzzles" aria-label="Go to Puzzles section" aria-controls="puzzles">üß© Puzzles</button>
        </nav>

        <!-- Dashboard Section -->
        <main id="main-content">
            <section id="dashboard" class="section active" role="region" aria-labelledby="dashboard-title">
            <h2 id="dashboard-title">Welcome to Your Learning Journey!</h2>
            <div class="stats-grid" role="list" aria-label="Learning statistics">
                <div class="stat-card" role="listitem">
                    <h3>üìö Words Learned</h3>
                    <p class="stat-number" id="wordsLearned" aria-live="polite" aria-atomic="true">0</p>
                </div>
                <div class="stat-card" role="listitem">
                    <h3>‚úçÔ∏è Sentences Completed</h3>
                    <p class="stat-number" id="sentencesCompleted" aria-live="polite" aria-atomic="true">0</p>
                </div>
                <div class="stat-card" role="listitem">
                    <h3>üìñ Reading Exercises</h3>
                    <p class="stat-number" id="readingCompleted" aria-live="polite" aria-atomic="true">0</p>
                </div>
                <div class="stat-card" role="listitem">
                    <h3>üß© Puzzles Solved</h3>
                    <p class="stat-number" id="puzzlesSolved" aria-live="polite" aria-atomic="true">0</p>
                </div>
            </div>
            <div class="daily-goal" role="complementary" aria-labelledby="daily-goal-title">
                <h3 id="daily-goal-title">Today's Goal</h3>
                <p>Complete at least one activity from each category!</p>
                <div class="goal-checklist" role="list" aria-label="Daily goal checklist">
                    <label><input type="checkbox" id="goalVocab" disabled aria-label="Vocabulary practice completed"> Vocabulary Practice</label>
                    <label><input type="checkbox" id="goalSentence" disabled aria-label="Sentence formation completed"> Sentence Formation</label>
                    <label><input type="checkbox" id="goalReading" disabled aria-label="Reading exercise completed"> Reading Exercise</label>
                    <label><input type="checkbox" id="goalListening" disabled aria-label="Listening practice completed"> Listening Practice</label>
                    <label><input type="checkbox" id="goalPuzzle" disabled aria-label="Puzzle activity completed"> Puzzle Activity</label>
                </div>
            </div>

            <!-- Statistics Section -->
            <div class="statistics-container" role="complementary" aria-label="Detailed statistics">
                <div class="stat-box" id="todayStats" aria-live="polite">
                    <h4>üìÖ Today's Progress</h4>
                    <p>Loading...</p>
                </div>
                <div class="stat-box" id="overallStats" aria-live="polite">
                    <h4>üìä Overall Statistics</h4>
                    <p>Loading...</p>
                </div>
                <div class="stat-box" id="averageStats" aria-live="polite">
                    <h4>üìà Daily Averages</h4>
                    <p>Loading...</p>
                </div>
            </div>
        </section>

        <!-- Vocabulary Section -->
        <section id="vocabulary" class="section" role="region" aria-labelledby="vocabulary-title">
            <h2 id="vocabulary-title">üìö Daily Vocabulary Practice</h2>
            <div class="difficulty-selector" role="radiogroup" aria-label="Select difficulty level">
                <button class="diff-btn active" data-level="basic" role="radio" aria-checked="true" aria-label="Basic difficulty">Basic</button>
                <button class="diff-btn" data-level="intermediate" role="radio" aria-checked="false" aria-label="Intermediate difficulty">Intermediate</button>
                <button class="diff-btn" data-level="medium" role="radio" aria-checked="false" aria-label="Medium difficulty">Medium</button>
            </div>
            <div class="vocab-container">
                <div class="word-card" id="wordCard" role="article" aria-labelledby="currentWord">
                    <h3 class="word" id="currentWord" aria-live="polite">Loading...</h3>
                    <p class="pronunciation" id="pronunciation" aria-label="Pronunciation"></p>
                    <p class="definition" id="definition" aria-label="Definition"></p>
                    <p class="example" id="example" aria-label="Example sentence"></p>
                    <button class="btn-primary" id="speakWord" aria-label="Pronounce the word">üîä Pronounce</button>
                </div>
                <div class="vocab-quiz" role="form" aria-labelledby="quiz-title">
                    <h3 id="quiz-title">Test Your Knowledge</h3>
                    <p id="quizQuestion" aria-live="polite"></p>
                    <div class="quiz-options" id="quizOptions" role="radiogroup" aria-label="Answer options"></div>
                    <div class="navigation-buttons" role="navigation" aria-label="Vocabulary navigation">
                        <button class="btn-secondary" id="prevWord" aria-label="Previous word">‚Üê Previous</button>
                        <button class="btn-primary" id="nextWord" aria-label="Next word">Next ‚Üí</button>
                    </div>
                </div>
                <div class="vocab-progress" aria-live="polite" aria-atomic="true">
                    <p>Today's Progress: <span id="vocabProgress">0/10</span></p>
                </div>
            </div>
        </section>

        <!-- Sentence Formation Section -->
        <section id="sentences" class="section" role="region" aria-labelledby="sentences-title">
            <h2 id="sentences-title">‚úçÔ∏è Sentence Formation Practice</h2>
            <div class="difficulty-selector" role="radiogroup" aria-label="Select difficulty level">
                <button class="diff-btn active" data-level="basic" role="radio" aria-checked="true" aria-label="Basic difficulty">Basic</button>
                <button class="diff-btn" data-level="intermediate" role="radio" aria-checked="false" aria-label="Intermediate difficulty">Intermediate</button>
                <button class="diff-btn" data-level="medium" role="radio" aria-checked="false" aria-label="Medium difficulty">Medium</button>
            </div>
            <div class="sentence-container">
                <!-- Drag and Drop Exercise -->
                <div class="exercise-card sentence-exercise-container" id="dragDropContainer" role="form" aria-labelledby="dragdrop-title">
                    <h3 id="dragdrop-title">Arrange the Words</h3>
                    <p class="instruction">Drag and drop the words to form a correct sentence:</p>
                    <div class="word-bank" id="wordBank" role="list" aria-label="Available words"></div>
                    <div class="sentence-builder" id="sentenceBuilder" role="region" aria-label="Sentence builder area" aria-live="polite">
                        <p class="placeholder">Drop words here...</p>
                    </div>
                </div>

                <!-- Fill in the Blanks Exercise -->
                <div class="exercise-card sentence-exercise-container" id="fillBlankExerciseContainer" style="display:none;" role="form" aria-labelledby="fillblank-title">
                    <h3 id="fillblank-title">Fill in the Blanks</h3>
                    <p class="instruction" id="fillBlankInstruction"></p>
                    <div class="fill-blank-container" id="fillBlankContainer" aria-label="Fill in the blank exercise"></div>
                </div>

                <!-- Multiple Choice Exercise -->
                <div class="exercise-card sentence-exercise-container" id="multipleChoiceContainer" style="display:none;" role="form" aria-labelledby="multiplechoice-title">
                    <h3 id="multiplechoice-title">Choose the Correct Sentence</h3>
                    <div id="multipleChoiceContent" role="radiogroup" aria-label="Sentence options"></div>
                </div>

                <!-- Reorder Words Exercise -->
                <div class="exercise-card sentence-exercise-container" id="reorderContainer" style="display:none;" role="form" aria-labelledby="reorder-title">
                    <h3 id="reorder-title">Build the Sentence</h3>
                    <div id="reorderContent" aria-label="Reorder words to form sentence"></div>
                </div>

                <!-- Universal Controls -->
                <div class="exercise-card">
                    <div class="button-group" role="group" aria-label="Exercise controls">
                        <button class="btn-primary" id="checkSentence" aria-label="Check your answer">Check Answer</button>
                        <button class="btn-secondary" id="resetSentence" aria-label="Reset exercise">Reset</button>
                        <button class="btn-hint" id="sentenceHint" style="display:none;" aria-label="Get a hint">üí° Get Hint</button>
                    </div>
                    <div class="hint-display" id="hintDisplay" role="status" aria-live="polite"></div>
                    <div class="navigation-buttons" role="navigation" aria-label="Sentence exercise navigation">
                        <button class="btn-secondary" id="prevSentence" aria-label="Previous sentence">‚Üê Previous</button>
                        <button class="btn-primary" id="nextSentence" aria-label="Next sentence">Next ‚Üí</button>
                    </div>
                    <div class="feedback" id="sentenceFeedback" role="status" aria-live="polite"></div>
                </div>
            </div>
        </section>

        <!-- Reading Section -->
        <section id="reading" class="section" role="region" aria-labelledby="reading-title">
            <h2 id="reading-title">üìñ Reading & Dictation Practice</h2>
            <div class="difficulty-selector" role="radiogroup" aria-label="Select difficulty level">
                <button class="diff-btn active" data-level="basic" role="radio" aria-checked="true" aria-label="Basic difficulty">Basic</button>
                <button class="diff-btn" data-level="intermediate" role="radio" aria-checked="false" aria-label="Intermediate difficulty">Intermediate</button>
                <button class="diff-btn" data-level="medium" role="radio" aria-checked="false" aria-label="Medium difficulty">Medium</button>
            </div>
            <div class="reading-container">
                <div class="reading-passage" role="article" aria-labelledby="passageTitle">
                    <h3 id="passageTitle">Loading...</h3>
                    <div class="passage-text" id="passageText" aria-label="Reading passage"></div>

                    <!-- Audio Controls -->
                    <div class="audio-controls" role="group" aria-label="Audio playback controls">
                        <button class="btn-primary" id="readAloud" aria-label="Play reading">‚ñ∂Ô∏è Play</button>
                        <button class="btn-secondary" id="pauseReading" style="display:none;" aria-label="Pause reading">‚è∏Ô∏è Pause</button>
                        <button class="btn-secondary" id="resumeReading" style="display:none;" aria-label="Resume reading">‚ñ∂Ô∏è Resume</button>
                        <button class="btn-secondary" id="stopReading" style="display:none;" aria-label="Stop reading">‚èπÔ∏è Stop</button>
                        <button class="btn-primary" id="replayReading" style="display:none;" aria-label="Replay reading">üîÑ Replay</button>
                    </div>

                    <div class="navigation-buttons" role="navigation" aria-label="Reading passage navigation">
                        <button class="btn-secondary" id="prevReading" aria-label="Previous passage">‚Üê Previous</button>
                        <button class="btn-primary" id="nextReading" aria-label="Next passage">Next ‚Üí</button>
                    </div>
                </div>
                <div class="comprehension-quiz" role="form" aria-labelledby="comprehension-title">
                    <h3 id="comprehension-title">Comprehension Questions</h3>
                    <div id="comprehensionQuestions" aria-label="Comprehension questions"></div>
                    <button class="btn-primary" id="checkComprehension" aria-label="Check comprehension answers">Check Answers</button>
                    <div class="feedback" id="comprehensionFeedback" role="status" aria-live="polite"></div>
                </div>
                <div class="dictation-exercise" role="form" aria-labelledby="dictation-title">
                    <h3 id="dictation-title">Dictation Practice</h3>
                    <p>Listen and type what you hear:</p>
                    <button class="btn-primary" id="playDictation" aria-label="Play dictation audio">‚ñ∂Ô∏è Play Audio</button>
                    <textarea id="dictationInput" placeholder="Type what you hear..." aria-label="Dictation input"></textarea>
                    <button class="btn-primary" id="checkDictation" aria-label="Check dictation answer">Check Answer</button>
                    <div class="feedback" id="dictationFeedback" role="status" aria-live="polite"></div>
                </div>
            </div>
        </section>

        <!-- Listening Section -->
        <section id="listening" class="section" role="region" aria-labelledby="listening-title">
            <h2 id="listening-title">üéß Listening & Speaking Practice</h2>
            <div class="listening-container">
                <div class="exercise-card" role="form" aria-labelledby="listen-repeat-title">
                    <h3 id="listen-repeat-title">Listen and Repeat</h3>
                    <p class="instruction">Click to hear the sentence, then repeat it:</p>
                    <div class="sentence-display" id="listenSentence" aria-live="polite"></div>
                    <button class="btn-primary" id="playListening" aria-label="Play listening sentence">üîä Play</button>
                    <button class="btn-primary" id="startRecording" aria-label="Start recording your voice">üé§ Record Your Voice</button>
                    <button class="btn-secondary" id="stopRecording" disabled aria-label="Stop recording">‚èπÔ∏è Stop</button>
                    <button class="btn-primary" id="replayRecording" style="display:none;" aria-label="Replay your recording">üîÑ Replay Recording</button>
                    <div class="recording-status" id="recordingStatus" role="status" aria-live="polite"></div>
                    <div class="feedback" id="listeningFeedback" role="status" aria-live="polite"></div>
                    <div class="navigation-buttons" role="navigation" aria-label="Listening exercise navigation">
                        <button class="btn-secondary" id="prevListening" aria-label="Previous listening exercise">‚Üê Previous</button>
                        <button class="btn-primary" id="nextListening" aria-label="Next listening exercise">Next ‚Üí</button>
                    </div>
                </div>
                <div class="exercise-card" role="form" aria-labelledby="speech-recognition-title">
                    <h3 id="speech-recognition-title">Speech Recognition Practice</h3>
                    <p class="instruction">Say the word shown below:</p>
                    <div class="target-word" id="targetWord" aria-live="polite" aria-label="Target word to say"></div>
                    <button class="btn-primary" id="startSpeech" aria-label="Start speech recognition">üé§ Start Speaking</button>
                    <div class="recognized-text" id="recognizedText" role="status" aria-live="polite"></div>
                    <div class="feedback" id="speechFeedback" role="status" aria-live="polite"></div>
                </div>
            </div>
        </section>

        <!-- Puzzles Section -->
        <section id="puzzles" class="section" role="region" aria-labelledby="puzzles-title">
            <h2 id="puzzles-title">üß© Fun Puzzles & Games</h2>
            <div class="puzzle-selector" role="tablist" aria-label="Select puzzle type">
                <button class="puzzle-btn active" data-puzzle="wordsearch" role="tab" aria-selected="true" aria-controls="wordsearch" aria-label="Word Search puzzle">Word Search</button>
                <button class="puzzle-btn" data-puzzle="crossword" role="tab" aria-selected="false" aria-controls="crossword" aria-label="Crossword puzzle">Crossword</button>
                <button class="puzzle-btn" data-puzzle="scramble" role="tab" aria-selected="false" aria-controls="scramble" aria-label="Word Scramble puzzle">Word Scramble</button>
                <button class="puzzle-btn" data-puzzle="matching" role="tab" aria-selected="false" aria-controls="matching" aria-label="Word Matching puzzle">Word Matching</button>
            </div>

            <!-- Word Search -->
            <div class="puzzle-container active" id="wordsearch" role="tabpanel" aria-labelledby="wordsearch-tab">
                <h3 id="wordsearch-tab">Word Search</h3>
                <p>Find all the hidden words!</p>
                <div class="word-list" id="searchWordList" role="list" aria-label="Words to find"></div>
                <div class="word-grid" id="wordGrid" role="grid" aria-label="Word search grid"></div>
                <button class="btn-primary" id="newWordSearch" aria-label="Generate new word search">New Puzzle</button>
            </div>

            <!-- Crossword -->
            <div class="puzzle-container" id="crossword" role="tabpanel" aria-labelledby="crossword-tab">
                <h3 id="crossword-tab">Mini Crossword</h3>
                <div class="crossword-clues" role="complementary" aria-label="Crossword clues">
                    <div class="clues-section">
                        <h4>Across</h4>
                        <div id="cluesAcross" aria-label="Across clues"></div>
                    </div>
                    <div class="clues-section">
                        <h4>Down</h4>
                        <div id="cluesDown" aria-label="Down clues"></div>
                    </div>
                </div>
                <div class="crossword-grid" id="crosswordGrid" role="grid" aria-label="Crossword grid"></div>
                <button class="btn-primary" id="checkCrossword" aria-label="Check crossword answers">Check Answers</button>
                <button class="btn-secondary" id="newCrossword" aria-label="Generate new crossword">New Puzzle</button>
            </div>

            <!-- Word Scramble -->
            <div class="puzzle-container" id="scramble" role="tabpanel" aria-labelledby="scramble-tab">
                <h3 id="scramble-tab">Word Scramble</h3>
                <p>Unscramble the letters to form a word:</p>
                <div class="scrambled-word" id="scrambledWord" aria-live="polite" aria-label="Scrambled word"></div>
                <input type="text" id="scrambleInput" placeholder="Type your answer..." aria-label="Your answer">
                <div class="hint" id="scrambleHint" role="status" aria-live="polite"></div>
                <button class="btn-primary" id="checkScramble" aria-label="Check scramble answer">Check</button>
                <button class="btn-secondary" id="showHint" aria-label="Show answer">Show Answer</button>
                <button class="btn-primary" id="nextScramble" aria-label="Next scrambled word">Next Word</button>
                <div class="feedback" id="scrambleFeedback" role="status" aria-live="polite"></div>
            </div>

            <!-- Word Matching -->
            <div class="puzzle-container" id="matching" role="tabpanel" aria-labelledby="matching-tab">
                <h3 id="matching-tab">Word Matching</h3>
                <p>Match words with their meanings:</p>
                <div class="matching-game" role="group" aria-label="Word matching game">
                    <div class="matching-column" id="wordsColumn" role="list" aria-label="Words"></div>
                    <div class="matching-column" id="meaningsColumn" role="list" aria-label="Meanings"></div>
                </div>
                <button class="btn-primary" id="checkMatching" aria-label="Check matches">Check Matches</button>
                <button class="btn-secondary" id="resetMatching" aria-label="Reset matching game">Reset</button>
                <div class="feedback" id="matchingFeedback" role="status" aria-live="polite"></div>
                </div>
            </section>
        </main>
    </div>

    <!-- Core Utilities (Load first) -->
    <script src="js/core/error-handler.js"></script>
    <script src="js/core/validator.js"></script>
    <script src="js/core/storage.js"></script>
    <script src="js/core/notification.js"></script>
    <script src="js/theme-toggle.js"></script>
    <script src="js/ui-enhancements.js"></script>

    <!-- Application Data & Logic -->
    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>